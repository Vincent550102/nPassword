(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{25296:(e,t,a)=>{Promise.resolve().then(a.bind(a,91164))},91164:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>J});var s=a(14045),n=a(16105),r=function(e){return e.ADD_DOMAIN="ADD_DOMAIN",e.DELETE_DOMAIN="DELETE_DOMAIN",e.SELECT_DOMAIN="SELECT_DOMAIN",e.ADD_ACCOUNT="ADD_ACCOUNT",e.DELETE_ACCOUNT="DELETE_ACCOUNT",e.UPDATE_ACCOUNT="UPDATE_ACCOUNT",e.ADD_TAG_TO_ACCOUNT="ADD_TAG_TO_ACCOUNT",e.REMOVE_TAG_FROM_ACCOUNT="REMOVE_TAG_FROM_ACCOUNT",e.LOAD_DOMAIN_DATA="LOAD_DOMAIN_DATA",e.RESET="RESET",e}({});let l={data:{domains:[]},selectedDomain:null},o=(e,t,a)=>({...e,accounts:e.accounts.map(e=>e.username===t?a(e):e)}),c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_DOMAIN":return{...e,data:{domains:[...e.data.domains,t.payload]}};case"DELETE_DOMAIN":var a;return{...e,data:{domains:e.data.domains.filter(e=>e.name!==t.payload)},selectedDomain:(null===(a=e.selectedDomain)||void 0===a?void 0:a.name)===t.payload?null:e.selectedDomain};case"SELECT_DOMAIN":return{...e,selectedDomain:t.payload};case"ADD_ACCOUNT":if(!e.selectedDomain)return e;let s=e.data.domains.map(a=>a.name===e.selectedDomain.name?{...a,accounts:[...a.accounts,t.payload.account]}:a);return{...e,data:{domains:s},selectedDomain:{...e.selectedDomain,accounts:[...e.selectedDomain.accounts,t.payload.account]}};case"DELETE_ACCOUNT":if(!e.selectedDomain)return e;let n=e.data.domains.map(a=>a.name===e.selectedDomain.name?{...a,accounts:a.accounts.filter(e=>e.username!==t.payload.username)}:a);return{...e,data:{domains:n},selectedDomain:{...e.selectedDomain,accounts:e.selectedDomain.accounts.filter(e=>e.username!==t.payload.username)}};case"UPDATE_ACCOUNT":if(!e.selectedDomain)return e;let{username:r,updatedAccount:c}=t.payload,i=e.data.domains.map(t=>t.name===e.selectedDomain.name?o(t,r,()=>c):t);return{...e,data:{domains:i},selectedDomain:o(e.selectedDomain,r,()=>c)};case"ADD_TAG_TO_ACCOUNT":if(!e.selectedDomain)return e;let{username:m,tag:d}=t.payload,u=e.data.domains.map(t=>t.name===e.selectedDomain.name?o(t,m,e=>({...e,tags:e.tags?[...e.tags,d]:[d]})):t);return{...e,data:{domains:u},selectedDomain:o(e.selectedDomain,m,e=>({...e,tags:e.tags?[...e.tags,d]:[d]}))};case"REMOVE_TAG_FROM_ACCOUNT":if(!e.selectedDomain)return e;let{username:p,tag:h}=t.payload,x=e.data.domains.map(t=>t.name===e.selectedDomain.name?o(t,p,e=>{var t;return{...e,tags:null===(t=e.tags)||void 0===t?void 0:t.filter(e=>e!==h)}}):t);return{...e,data:{domains:x},selectedDomain:o(e.selectedDomain,p,e=>{var t;return{...e,tags:null===(t=e.tags)||void 0===t?void 0:t.filter(e=>e!==h)}})};case"LOAD_DOMAIN_DATA":if(e.data.domains.some(e=>e.name===t.payload.name))return e;return{...e,data:{domains:[...e.data.domains,t.payload]},selectedDomain:t.payload};case"RESET":return{...l,data:t.payload||l.data};default:return e}};var i=function(e){return e.SELECT_ACCOUNT="SELECT_ACCOUNT",e.CLEAR_SELECTION="CLEAR_SELECTION",e}({});let m={selectedAccount:null},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_ACCOUNT":return{...e,selectedAccount:t.payload};case"CLEAR_SELECTION":return{...e,selectedAccount:null};default:return e}},u={domain:l,account:m},p=(0,n.createContext)(void 0);function h(e,t){if("DOMAIN"===t.type){var a,s;let n=c(e.domain,t.action),r=(null===(a=n.selectedDomain)||void 0===a?void 0:a.name)!==(null===(s=e.domain.selectedDomain)||void 0===s?void 0:s.name);return{domain:n,account:r?m:e.account}}if("ACCOUNT"===t.type){if(t.action.type===i.SELECT_ACCOUNT){let a=t.action.payload.username;if(!e.domain.selectedDomain||!e.domain.selectedDomain.accounts.some(e=>e.username===a))return e}return{...e,account:d(e.account,t.action)}}return e}let x=e=>{let{children:t}=e,a=(0,n.useRef)(!1),[l,o]=(0,n.useReducer)(h,u);return(0,n.useEffect)(()=>{if(!a.current){try{let e=localStorage.getItem("passwordManagerData");if(e){let t=JSON.parse(e);if(Array.isArray(t.domains)&&t.domains.length>0&&(o({type:"DOMAIN",action:{type:r.RESET,payload:{domains:t.domains}}}),t.selectedDomain)){let e=t.domains.find(e=>e.name===t.selectedDomain);e&&o({type:"DOMAIN",action:{type:r.SELECT_DOMAIN,payload:e}})}}}catch(e){console.error("Failed to load data from localStorage:",e)}a.current=!0}},[]),(0,n.useEffect)(()=>{if(a.current)try{var e;let t={domains:l.domain.data.domains,selectedDomain:null===(e=l.domain.selectedDomain)||void 0===e?void 0:e.name};localStorage.setItem("passwordManagerData",JSON.stringify(t))}catch(e){console.error("Failed to save data to localStorage:",e)}},[l.domain.data.domains,l.domain.selectedDomain]),(0,s.jsx)(p.Provider,{value:{state:l,dispatch:o},children:t})},g=()=>{let e=(0,n.useContext)(p);if(void 0===e)throw Error("useStore must be used within a StoreProvider");return e},y=()=>{let{dispatch:e}=g();return{addDomain:t=>e({type:"DOMAIN",action:{type:r.ADD_DOMAIN,payload:t}}),deleteDomain:t=>e({type:"DOMAIN",action:{type:r.DELETE_DOMAIN,payload:t}}),selectDomain:t=>e({type:"DOMAIN",action:{type:r.SELECT_DOMAIN,payload:t}}),addAccount:t=>e({type:"DOMAIN",action:{type:r.ADD_ACCOUNT,payload:{account:t}}}),deleteAccount:t=>e({type:"DOMAIN",action:{type:r.DELETE_ACCOUNT,payload:{username:t}}}),updateAccount:(t,a)=>e({type:"DOMAIN",action:{type:r.UPDATE_ACCOUNT,payload:{username:t,updatedAccount:a}}}),addTagToAccount:(t,a)=>e({type:"DOMAIN",action:{type:r.ADD_TAG_TO_ACCOUNT,payload:{username:t,tag:a}}}),removeTagFromAccount:(t,a)=>e({type:"DOMAIN",action:{type:r.REMOVE_TAG_FROM_ACCOUNT,payload:{username:t,tag:a}}}),loadDomainData:t=>e({type:"DOMAIN",action:{type:r.LOAD_DOMAIN_DATA,payload:t}})}},b=()=>{let{dispatch:e}=g();return{selectAccount:t=>e({type:"ACCOUNT",action:{type:i.SELECT_ACCOUNT,payload:t}}),clearAccountSelection:()=>e({type:"ACCOUNT",action:{type:i.CLEAR_SELECTION}})}},f=()=>{let{state:e}=g();return{domains:e.domain.data.domains,selectedDomain:e.domain.selectedDomain,selectedAccount:e.account.selectedAccount}};function N(e){let{children:t,onCloseAction:a}=e,r=(0,n.useRef)(null),[l,o]=(0,n.useState)(!1),c=(0,n.useCallback)(()=>{o(!1),setTimeout(a,300)},[a]),i=(0,n.useCallback)(e=>{r.current&&!r.current.contains(e.target)&&c()},[c]),m=(0,n.useCallback)(e=>{"Escape"===e.key&&c()},[c]);return(0,n.useEffect)(()=>{let e=setTimeout(()=>o(!0),10);return document.addEventListener("mousedown",i),document.addEventListener("keydown",m),document.body.style.overflow="hidden",()=>{document.removeEventListener("mousedown",i),document.removeEventListener("keydown",m),document.body.style.overflow="",clearTimeout(e)}},[i,m]),(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center text-black transition-opacity duration-300 z-50 p-4 ".concat(l?"opacity-100":"opacity-0"),role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{ref:r,className:"\n          bg-white rounded-lg shadow-xl relative\n          transform transition-transform duration-300\n          w-full md:w-1/3 max-h-[90vh] overflow-y-auto\n          ".concat(l?"scale-100":"scale-90","\n        "),children:[(0,s.jsx)("button",{onClick:c,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 text-xl","aria-label":"Close dialog",children:"\xd7"}),t]})})}let j=e=>{let{label:t,error:a,className:n="",...r}=e;return(0,s.jsxs)("div",{children:[t&&(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:t}),(0,s.jsx)("input",{className:"border rounded p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(a?"border-red-500":"border-gray-300"," ").concat(n),...r}),a&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:a})]})};var w=a(34126),v=a(65898);let H=e=>{let{domains:t,onCloseAction:a,onSelectDomain:r,onAddDomain:l,onLoadDomain:o}=e,[c,i]=(0,n.useState)(""),[m,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(""),[h,x]=(0,n.useState)(null),{deleteDomain:g}=y(),b=()=>{if(!c.trim()){p("Domain name cannot be empty");return}if(t.some(e=>e.name.toLowerCase()===c.trim().toLowerCase())){p("Domain with this name already exists");return}l({name:c.trim(),accounts:[]}),i(""),d(!1)},f=e=>{g(e),x(null),v.oR.success('Domain "'.concat(e,'" deleted successfully!'))};return(0,s.jsxs)(N,{onCloseAction:a,children:[(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"Select Domain"}),t.length>0?(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Existing Domains"}),(0,s.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:t.map(e=>(0,s.jsxs)("div",{className:"p-3 bg-gray-100 hover:bg-gray-200 transition-colors rounded-md cursor-pointer flex justify-between items-center group",children:[(0,s.jsxs)("div",{className:"flex-1",onClick:()=>r(e),children:[(0,s.jsx)("span",{className:"font-medium",children:e.name}),(0,s.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:[e.accounts.length," ",1===e.accounts.length?"account":"accounts"]})]}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),x(e.name)},className:"p-1.5 rounded-full text-gray-500 hover:text-red-600 hover:bg-red-50 opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete domain",children:(0,s.jsx)(w.qbC,{size:14})})]},e.name))})]}):(0,s.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,s.jsx)("p",{className:"text-blue-800",children:"No domains found. Create a new domain or import one to get started."})}),m?(0,s.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-md",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Create New Domain"}),(0,s.jsx)(j,{type:"text",value:c,onChange:e=>{i(e.target.value),p("")},onKeyDown:e=>{"Enter"===e.key&&b()},placeholder:"Domain name (e.g., example.com)",className:"mb-3 w-full",autoFocus:!0}),u&&(0,s.jsx)("p",{className:"text-red-500 text-sm mb-3",children:u}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("button",{onClick:b,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md transition-colors",disabled:!c.trim(),children:"Create Domain"}),(0,s.jsx)("button",{onClick:()=>{d(!1),p("")},className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md transition-colors",children:"Cancel"})]})]}):(0,s.jsxs)("button",{onClick:()=>d(!0),className:"flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md mb-6 w-full transition-colors",children:[(0,s.jsx)(w.OiG,{className:"mr-2"}),"Create New Domain"]}),(0,s.jsxs)("div",{className:"border-t pt-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Import Domain"}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("label",{className:"flex items-center justify-center bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md cursor-pointer transition-colors",children:[(0,s.jsx)(w.HVe,{className:"mr-2"}),"Import from JSON",(0,s.jsx)("input",{type:"file",accept:".json",onChange:o,className:"hidden"})]}),(0,s.jsx)("span",{className:"text-sm text-gray-500 ml-4",children:"Select a previously exported domain file"})]})]})]}),h&&(0,s.jsx)(N,{onCloseAction:()=>x(null),children:(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"flex items-center text-red-600 mb-4",children:[(0,s.jsx)(w.qbC,{size:22,className:"mr-3"}),(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Delete Domain"})]}),(0,s.jsxs)("p",{className:"mb-4",children:["Are you sure you want to delete the domain"," ",(0,s.jsx)("strong",{children:h}),"?"]}),(0,s.jsx)("p",{className:"mb-6 text-gray-600 text-sm bg-yellow-50 p-3 rounded border border-yellow-200",children:"This action cannot be undone. All accounts and credentials in this domain will be permanently removed."}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>x(null),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded text-gray-800",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>f(h),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded text-white",children:"Delete Domain"})]})]})})]})};var C=a(71816),T=a.n(C);function D(e){if(!e)return"";try{let t=new Uint8Array(2*e.length);for(let a=0;a<e.length;a++){let s=e.charCodeAt(a);t[2*a]=255&s,t[2*a+1]=s>>8}return T()(t)}catch(e){return console.error("Error calculating NT hash:",e),""}}let A=e=>{let{onChange:t,initialType:a="domain"}=e,[r,l]=(0,n.useState)(a),o=e=>{l(e),t(e)};return(0,n.useEffect)(()=>{a!==r&&t(a)},[a,t,r]),(0,s.jsxs)("div",{className:"flex justify-center my-4",children:[(0,s.jsx)("button",{className:"px-4 py-2 rounded-r ".concat("domain"===r?"bg-blue-500 text-white":"bg-gray-200"),onClick:()=>o("domain"),children:"Domain Account"}),(0,s.jsx)("button",{className:"px-4 py-2 rounded-l ".concat("local"===r?"bg-blue-500 text-white":"bg-gray-200"),onClick:()=>o("local"),children:"Local Account"})]})},E=e=>{let{initialData:t,onSubmit:a,onCancel:r,submitLabel:l,error:o}=e,[c,i]=(0,n.useState)(t),[m,d]=(0,n.useState)(""),[u,p]=(0,n.useState)(!1),[h,x]=(0,n.useState)(""===t.ntlmHash),g=(0,n.useRef)(null),y=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(h&&c.password){let e=D(c.password);i(t=>({...t,ntlmHash:e}))}},[c.password,h]);let b=(0,n.useCallback)(()=>{""!==c.username.trim()&&(""!==c.password.trim()||""!==c.ntlmHash.trim())&&a({username:c.username,type:c.type,...c.password?{password:c.password}:{},...c.ntlmHash?{ntlmHash:c.ntlmHash}:{},...c.tags.length>0?{tags:c.tags}:{},...c.host?{host:c.host}:{}})},[c,a]);(0,n.useEffect)(()=>{let e=e=>{var t;if("Enter"===e.key){if(u&&document.activeElement===y.current||document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLButtonElement)return;(null===(t=g.current)||void 0===t?void 0:t.contains(document.activeElement))&&(e.preventDefault(),b())}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[u,b]);let f=(e,t)=>{"ntlmHash"===e&&h&&x(!1),i({...c,[e]:t})},N=()=>{""!==m.trim()&&(i({...c,tags:[...c.tags,m]}),d(""),p(!1))},w=e=>{i({...c,tags:c.tags.filter(t=>t!==e)})};return(0,s.jsxs)("div",{className:"space-y-4",ref:g,children:[(0,s.jsx)(A,{onChange:e=>f("type",e),initialType:c.type}),"local"===c.type&&(0,s.jsx)(j,{type:"text",value:c.host,onChange:e=>f("host",e.target.value),placeholder:"Host",className:"border p-2 mb-4 w-full text-black"}),(0,s.jsx)(j,{type:"text",value:c.username,onChange:e=>f("username",e.target.value),placeholder:"Username",className:"border p-2 mb-4 w-full text-black"}),(0,s.jsx)(j,{type:"text",value:c.password,onChange:e=>f("password",e.target.value),placeholder:"Password",className:"border p-2 mb-4 w-full text-black"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(j,{type:"text",value:c.ntlmHash,onChange:e=>f("ntlmHash",e.target.value),placeholder:"NTLM Hash",className:"border p-2 mb-4 w-full text-black ".concat(h?"bg-gray-100":""),disabled:h}),(0,s.jsxs)("div",{className:"flex items-center mt-1 mb-4",children:[(0,s.jsx)("input",{type:"checkbox",id:"autoNTHash",checked:h,onChange:()=>{if(x(!h),!h&&c.password){let e=D(c.password);i(t=>({...t,ntlmHash:e}))}},className:"mr-2"}),(0,s.jsx)("label",{htmlFor:"autoNTHash",className:"text-sm text-gray-600",children:"Auto-generate NT hash from password"})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-lg mb-2",children:"Tags"}),(0,s.jsxs)("div",{className:"flex flex-wrap mb-2",children:[c.tags.map(e=>(0,s.jsxs)("span",{className:"bg-blue-200 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded cursor-pointer",onClick:()=>w(e),children:[e," \xd7"]},e)),u?(0,s.jsx)("input",{type:"text",value:m,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),N())},placeholder:"New tag",className:"bg-blue-200 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded",autoFocus:!0,ref:y}):(0,s.jsx)("button",{onClick:()=>p(!0),className:"bg-gray-200 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded",type:"button",children:"+ Add Tag"})]})]}),o&&(0,s.jsx)("p",{className:"text-red-500 mb-4",children:o}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{onClick:r,className:"bg-gray-500 text-white p-2 mr-2",type:"button",children:"Cancel"}),(0,s.jsx)("button",{onClick:b,className:"bg-blue-500 text-white p-2 w-32",type:"button",children:l})]})]})},k=e=>{let{className:t=""}=e,{selectedDomain:a,selectedAccount:r}=f(),{selectAccount:l}=b(),{addAccount:o,deleteAccount:c,updateAccount:i}=y(),m=(0,n.useRef)(null),[d,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!1),[x,g]=(0,n.useState)(null),[j,v]=(0,n.useState)(""),[H,C]=(0,n.useState)(""),[T,D]=(0,n.useState)(!1),[A,k]=(0,n.useState)([]);if((0,n.useEffect)(()=>{if(!a){k([]);return}k(""===H.trim()?a.accounts:a.accounts.filter(e=>{var t;return e.username.toLowerCase().includes(H.toLowerCase())||(null===(t=e.tags)||void 0===t?void 0:t.some(e=>e.toLowerCase().includes(H.toLowerCase())))}))},[a,H]),(0,n.useEffect)(()=>{if(!a)return;let e=e=>{if(!(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLButtonElement)&&("ArrowUp"===e.key||"ArrowDown"===e.key)){var t;let a;if(e.preventDefault(),0===A.length)return;let s=r?A.findIndex(e=>e.username===r.username):-1;a="ArrowUp"===e.key?s<=0?A.length-1:s-1:s>=A.length-1?0:s+1,l(A[a]);let n=null===(t=m.current)||void 0===t?void 0:t.querySelectorAll("[data-account-item]");n&&n[a]&&n[a].scrollIntoView({behavior:"smooth",block:"nearest"})}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[A,r,l,a]),!a)return null;let O=e=>{g(e)};return(0,s.jsxs)("div",{className:"bg-gray-50 h-full flex flex-col border-r border-gray-200 ".concat(t),tabIndex:0,children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between bg-white",children:[(0,s.jsx)("h2",{className:"font-semibold text-gray-800 text-lg",children:a.name}),(0,s.jsx)("button",{onClick:()=>{u(!0),v("")},className:"w-8 h-8 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-full flex items-center justify-center transition-colors duration-200","aria-label":"Add new account",title:"Add new account",children:(0,s.jsx)(w.OiG,{size:14})})]}),(0,s.jsx)("div",{className:"px-3 py-2 bg-white border-b border-gray-200 transition-all duration-200 ".concat(T?"shadow-sm":""),children:(0,s.jsxs)("div",{className:"flex items-center bg-gray-100 rounded-md px-3 py-1.5 ".concat(T?"ring-2 ring-blue-200 bg-white":"hover:bg-gray-200"),children:[(0,s.jsx)(w.KSO,{className:"text-gray-400 mr-2",size:14}),(0,s.jsx)("input",{type:"text",placeholder:"Search accounts...",className:"bg-transparent border-none w-full text-sm outline-none placeholder-gray-400 text-gray-700",value:H,onChange:e=>C(e.target.value),onFocus:()=>D(!0),onBlur:()=>D(!1)})]})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden py-2 px-2",ref:m,children:[0===A.length&&(0,s.jsx)("div",{className:"text-center py-10 px-4",children:H?(0,s.jsxs)("div",{className:"text-gray-500",children:[(0,s.jsx)("p",{className:"mb-1 text-sm",children:"No matching accounts found"}),(0,s.jsx)("p",{className:"text-xs",children:"Try a different search term"})]}):(0,s.jsxs)("div",{className:"text-gray-500",children:[(0,s.jsx)("p",{className:"mb-1 text-sm",children:"No accounts yet"}),(0,s.jsx)("p",{className:"text-xs",children:"Click the + button to add your first account"})]})}),A.map(e=>{let t=(null==r?void 0:r.username)===e.username,n=e.username.endsWith("$");return(0,s.jsx)("div",{"data-account-item":"true",onClick:()=>l(e),className:"\n                mb-1.5 rounded-lg p-3\n                cursor-pointer\n                transition-all duration-150\n                group\n                hover:bg-gray-100\n                ".concat(t?"bg-blue-50 hover:bg-blue-50 shadow-sm":"bg-white","\n              "),children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"\n                  flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center mr-3\n                  ".concat(t?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-500","\n                "),children:n?(0,s.jsx)(w.Wqt,{size:16}):(0,s.jsx)(w.x$1,{size:16})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"flex items-baseline mb-0.5",children:(0,s.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[90%]",children:"local"===e.type?e.host?e.host+"\\":"local\\":a.name+"\\"})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-medium truncate max-w-[75%] ".concat(t?"text-blue-700":"text-gray-800"),children:e.username}),(0,s.jsxs)("div",{className:"flex space-x-1 ".concat(t?"opacity-100":"opacity-0 group-hover:opacity-100"," transition-opacity duration-150"),children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e),h(!0)},className:"p-1 rounded hover:bg-gray-200 text-gray-500 hover:text-blue-600 transition-colors","aria-label":"Edit account",children:(0,s.jsx)(w.uO9,{size:14})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),O(e.username)},className:"p-1 rounded hover:bg-gray-200 text-gray-500 hover:text-red-600 transition-colors","aria-label":"Delete account",children:(0,s.jsx)(w.qbC,{size:14})})]})]}),e.tags&&e.tags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap mt-1.5 gap-1.5",children:e.tags.map(e=>(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full max-w-[120px] truncate ".concat(t?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700"),children:e},e))})]})]})},e.username)})]}),(0,s.jsx)("div",{className:"p-3 border-t border-gray-200 bg-white text-xs text-gray-500",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{children:[A.length," account",1!==A.length?"s":""]}),a.accounts.length>0&&H&&(0,s.jsx)("button",{onClick:()=>C(""),className:"text-blue-600 hover:text-blue-800",children:"Clear search"})]})}),d&&(0,s.jsx)(N,{onCloseAction:()=>u(!1),children:(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add New Account"}),(0,s.jsx)(E,{initialData:{username:"",password:"",ntlmHash:"",tags:[],type:"domain",host:""},onSubmit:e=>{if(a.accounts.some(t=>t.username===e.username)){v("Username already exists.");return}o(e),u(!1),v("")},onCancel:()=>u(!1),submitLabel:"Add Account",error:j})]})}),p&&r&&(0,s.jsx)(N,{onCloseAction:()=>h(!1),children:(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Edit Account"}),(0,s.jsx)(E,{initialData:{username:r.username,password:r.password||"",ntlmHash:r.ntlmHash||"",tags:r.tags||[],type:r.type,host:r.host||""},onSubmit:e=>{r&&(i(r.username,e),h(!1))},onCancel:()=>h(!1),submitLabel:"Update Account"})]})}),x&&(0,s.jsx)(N,{onCloseAction:()=>g(null),children:(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Confirm Delete"}),(0,s.jsxs)("p",{className:"mb-6",children:['Are you sure you want to delete the account "',(0,s.jsx)("span",{className:"font-medium",children:x}),'"?']}),(0,s.jsxs)("div",{className:"flex justify-end mt-4 space-x-3",children:[(0,s.jsx)("button",{onClick:()=>g(null),className:"bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{x&&(c(x),g(null))},className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors",children:"Delete"})]})]})})]})},O=e=>{let{selectedAccount:t,selectedDomain:a}=e,n=(e,t)=>{navigator.clipboard.writeText(e).then(()=>{v.oR.success("".concat(t," copied to clipboard"))},()=>{v.oR.error("Failed to copy ".concat(t))})},r=t.username.endsWith("$"),l="domain"===t.type?"".concat(a.name,"\\").concat(t.username):"".concat(t.host||"local","\\").concat(t.username),o="'".concat(a.name,"'/'").concat(t.username,"':'").concat(t.password||"","'"),c=t.ntlmHash?"'".concat(a.name,"'/'").concat(t.username,"' -hashes ':").concat(t.ntlmHash,"'"):"'".concat(a.name,"'/'").concat(t.username,"' -hashes ':00000000000000000000000000000000'");return(0,s.jsxs)("div",{className:"p-2 bg-gray-50",children:[(0,s.jsxs)("div",{className:"bg-white p-2 rounded border border-gray-200 mb-2",children:[(0,s.jsxs)("div",{className:"flex mb-1",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center mr-2 ".concat(r?"bg-blue-100 text-blue-600":"bg-green-100 text-green-600"),children:r?(0,s.jsx)(w.Wqt,{size:20}):(0,s.jsx)(w.x$1,{size:20})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:t.username}),r&&(0,s.jsx)("span",{className:"ml-2 bg-blue-50 text-blue-700 px-2 py-0.5 rounded text-xs",children:"Computer"}),t.tags&&t.tags.length>0&&(0,s.jsx)("div",{className:"ml-3 flex flex-wrap gap-1",children:t.tags.map(e=>(0,s.jsx)("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full text-xs",children:e},e))})]}),(0,s.jsxs)("div",{className:"flex items-center mt-1",children:[(0,s.jsx)("code",{className:"bg-gray-50 px-2 py-0.5 rounded text-sm font-mono truncate text-gray-700 flex-grow",children:l}),(0,s.jsx)("button",{onClick:()=>n(l,"Username"),className:"ml-1 p-1 rounded hover:bg-gray-100 text-gray-600",title:"Copy username",children:(0,s.jsx)(w.paH,{size:14})})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-x-3 gap-y-0.5 mt-1 text-sm border-t border-gray-100 pt-1",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"text-gray-600 font-medium w-16",children:"Type:"}),(0,s.jsx)("span",{children:r?"Computer Account":"User Account"})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"text-gray-600 font-medium w-16",children:"Domain:"}),(0,s.jsx)("span",{children:"domain"===t.type?a.name:t.host||"Local"})]}),t.host&&(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"text-gray-600 font-medium w-16",children:"Host:"}),(0,s.jsx)("span",{children:t.host})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[t.password&&(0,s.jsxs)("div",{className:"bg-white p-2 rounded border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center mb-0.5",children:[(0,s.jsx)(w.pXu,{className:"mr-1 text-blue-500",size:14}),(0,s.jsx)("span",{className:"font-medium text-sm text-gray-700",children:"Password"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("code",{className:"flex-1 bg-gray-50 p-1 rounded text-sm font-mono truncate",children:t.password}),(0,s.jsx)("button",{onClick:()=>n(t.password||"","Password"),className:"ml-1 p-1 rounded hover:bg-gray-100 text-gray-600",title:"Copy password",children:(0,s.jsx)(w.paH,{size:14})})]})]}),!t.password&&(0,s.jsxs)("div",{className:"bg-white p-2 rounded border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center mb-0.5",children:[(0,s.jsx)(w.pXu,{className:"mr-1 text-gray-400",size:14}),(0,s.jsx)("span",{className:"font-medium text-sm text-gray-400",children:"Password"})]}),(0,s.jsx)("div",{className:"text-gray-500 text-sm italic p-1",children:"No password stored"})]})]}),(0,s.jsxs)("div",{children:[t.ntlmHash&&(0,s.jsxs)("div",{className:"bg-white p-2 rounded border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center mb-0.5",children:[(0,s.jsx)(w.OIO,{className:"mr-1 text-blue-500",size:14}),(0,s.jsx)("span",{className:"font-medium text-sm text-gray-700",children:"NTLM Hash"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("code",{className:"flex-1 bg-gray-50 p-1 rounded text-sm font-mono overflow-x-auto whitespace-nowrap",style:{maxWidth:"calc(100% - 30px)"},children:t.ntlmHash}),(0,s.jsx)("button",{onClick:()=>n(t.ntlmHash||"","NTLM Hash"),className:"ml-1 p-1 rounded hover:bg-gray-100 text-gray-600 flex-shrink-0",title:"Copy NTLM hash",children:(0,s.jsx)(w.paH,{size:14})})]})]}),!t.ntlmHash&&(0,s.jsxs)("div",{className:"bg-white p-2 rounded border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center mb-0.5",children:[(0,s.jsx)(w.OIO,{className:"mr-1 text-gray-400",size:14}),(0,s.jsx)("span",{className:"font-medium text-sm text-gray-400",children:"NTLM Hash"})]}),(0,s.jsx)("div",{className:"text-gray-500 text-sm italic p-1",children:"No NTLM hash stored"})]})]})]}),(0,s.jsxs)("div",{className:"mt-2 bg-blue-50 p-2 rounded border border-blue-100",children:[(0,s.jsx)("div",{className:"font-medium mb-0.5 text-xs text-blue-700",children:"Quick Copy Format:"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"bg-white rounded border border-blue-100 p-1",children:[(0,s.jsx)("code",{className:"text-xs font-mono block truncate",children:o}),(0,s.jsxs)("button",{onClick:()=>n(o,"Username:Password format"),className:"mt-1 w-full flex items-center justify-center py-0.5 text-xs bg-blue-50 hover:bg-blue-100 rounded text-blue-700",children:[(0,s.jsx)(w.paH,{size:10,className:"mr-1"})," Copy User:Pass Format"]})]}),(0,s.jsxs)("div",{className:"bg-white rounded border border-blue-100 p-1",children:[(0,s.jsx)("code",{className:"text-xs font-mono block truncate",children:c}),(0,s.jsxs)("button",{onClick:()=>n(c,"Hash command format"),className:"mt-1 w-full flex items-center justify-center py-0.5 text-xs bg-blue-50 hover:bg-blue-100 rounded text-blue-700",disabled:!t.ntlmHash,children:[(0,s.jsx)(w.paH,{size:10,className:"mr-1"})," Copy Hash Format"]})]})]})]})]})};var _=a(41982);let L=[{template:"impacket-wmiexec '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-psexec '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-smbexec '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-dcomexec '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-atexec '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-smbclient '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-mssqlclient '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"nxc smb '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc ssh '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc ldap '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc ftp '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc wmi '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc winrm '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc rdp '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc vnc '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc mssql '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"nxc nfs '{targetHost}' -u '{username}' -p '{password}'",authType:"password"},{template:"certipy find -u '{username}@{domain}' -p '{password}' -dc-ip '{targetHost}'",authType:"password"},{template:"bloodyAD --host '{targetHost}' -d '{domain}' -u '{username}' -p '{password}'",authType:"password"},{template:"xfreerdp /u:'{username}' /d:'{domain}' /p:'{password}' /v:'{targetHost}' /drive:.,linux /bpp:8 /compression -themes -wallpaper /clipboard /audio-mode:0 /auto-reconnect -glyph-cache",authType:"password"},{template:"bloodhound-python -d '{domain}' -ns '{targetHost}' -u '{username}' -p '{password}' -c all",authType:"password"},{template:"evil-winrm -u '{username}' -p '{password}' -i '{targetHost}'",authType:"password"},{template:"impacket-GetUserSPNs -request -dc-ip '{targetHost}' '{domain}'/'{username}':'{password}' -outputfile hashes.kerberoast",authType:"password"},{template:"impacket-GetNPUsers -request -dc-ip '{targetHost}' '{domain}'/'{username}':'{password}'",authType:"password"},{template:"impacket-secretsdump -outputfile 'dcsync.dump' '{domain}'/'{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"rpcclient -U '{domain}/{username}' --password '{password}' '{targetHost}'",authType:"password"},{template:"impacket-wmiexec '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-psexec '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-smbexec '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-dcomexec '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-atexec '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-smbclient '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-mssqlclient '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"nxc smb '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc ssh '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc ldap '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc ftp '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc wmi '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc winrm '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc rdp '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc vnc '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc mssql '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"nxc nfs '{targetHost}' -u '{username}' -H '{ntlmHash}'",authType:"ntlmHash"},{template:"certipy find -u '{username}@{domain}' -hashes '00:{ntlmHash}' -dc-ip '{targetHost}'",authType:"ntlmHash"},{template:"bloodyAD --host '{targetHost}' -d '{domain}' -u '{username}' -p '00:{ntlmHash}'",authType:"ntlmHash"},{template:"xfreerdp /u:'{username}' /d:'{domain}' /pth:'{ntlmHash}' /v:'{targetHost}' /cert-ignore /dynamic-resolution",authType:"ntlmHash"},{template:"evil-winrm -u '{username}' -H '{ntlmHash}' -i '{targetHost}'",authType:"ntlmHash"},{template:"bloodhound-python -d '{domain}' -ns '{targetHost}' -u '{username}' --hashes '{ntlmHash}' -c all",authType:"ntlmHash"},{template:"impacket-GetUserSPNs -request -dc-ip '{targetHost}' '{domain}'/'{username}' -hashes '00:{ntlmHash}' -outputfile hashes.kerberoast",authType:"ntlmHash"},{template:"impacket-GetNPUsers -request -dc-ip '{targetHost}' '{domain}'/'{username}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-secretsdump -outputfile 'dcsync.dump' '{domain}'/'{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"rpcclient -U '{domain}/{username}' --pw-nt-hash '{ntlmHash}' '{targetHost}'",authType:"ntlmHash"}],S=[{template:"impacket-wmiexec '{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-psexec '{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-smbexec '{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-smbclient '{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-mssqlclient '{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-dcomexec '{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"impacket-atexec '{username}':'{password}'@'{targetHost}'",authType:"password"},{template:"xfreerdp /u:'{username}' /p:'{password}' /v:'{targetHost}' /cert-ignore /dynamic-resolution /drive:.,linux /bpp:8 /compression -themes -wallpaper /clipboard /audio-mode:0 /auto-reconnect -glyph-cache",authType:"password"},{template:"evil-winrm -u '{username}' -p '{password}' -i '{targetHost}'",authType:"password"},{template:"rpcclient -U '{username}' --password '{password}' '{targetHost}'",authType:"password"},{template:"impacket-wmiexec '{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-psexec '{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-smbexec '{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-dcomexec '{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-atexec '{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-smbclient '{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"impacket-mssqlclient '{username}'@'{targetHost}' -hashes '00:{ntlmHash}'",authType:"ntlmHash"},{template:"xfreerdp /u:'{username}' /pth:'{ntlmHash}' /v:'{targetHost}' /cert-ignore /dynamic-resolution",authType:"ntlmHash"},{template:"evil-winrm -u '{username}' -H '{ntlmHash}' -i '{targetHost}'",authType:"ntlmHash"},{template:"rpcclient -U '{username}' --pw-nt-hash '{ntlmHash}' '{targetHost}'",authType:"ntlmHash"}],U=e=>{let{selectedAccount:t,selectedDomain:a,targetHost:s,searchTerm:r}=e,l=(0,n.useCallback)(e=>{try{navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e):(e=>{let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)})(e),v.oR.success("Copied to clipboard!",{position:"bottom-center",autoClose:2e3})}catch(e){console.error("Failed to copy: ",e),v.oR.error("Failed to copy to clipboard",{position:"bottom-center",autoClose:2e3})}},[]),o=(0,n.useCallback)(e=>e.replace(/'/g,"'\"'\"'"),[]),c=(e,t)=>e.replace(/\{(\w+)\}/g,(e,a)=>a in t?t[a]:e);return{getFilteredCommands:(0,n.useCallback)(()=>t&&a?("local"===t.type?S:L).filter(e=>e.template.toLowerCase().includes(r.toLowerCase())).map(e=>{let n="password"===e.authType&&t.password,r="ntlmHash"===e.authType&&t.ntlmHash;if(!n&&!r)return null;let l={username:o(t.username),domain:o(a.name)};s&&(l.targetHost=o(s)),n&&t.password?l.password=o(t.password):r&&t.ntlmHash&&(l.ntlmHash=o(t.ntlmHash));let i=c(e.template,l);return{command:e,commandText:i}}).filter(e=>null!==e):[],[t,a,s,r,o]),copyToClipboard:l}},M=e=>{let{selectedAccount:t,selectedDomain:a,targetHost:r,searchTerm:l}=e,{getFilteredCommands:o,copyToClipboard:c}=U({selectedAccount:t,selectedDomain:a,targetHost:r,searchTerm:l}),i=(0,n.useMemo)(()=>o(),[o]);return i.length?(0,s.jsx)("ul",{className:"space-y-4",children:i.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start group",children:[(0,s.jsx)("div",{className:"p-2 rounded border border-gray-300 hover:bg-gray-100 cursor-pointer mr-2 transition-colors duration-200",onClick:()=>c(e.commandText),title:"Copy to clipboard",children:(0,s.jsx)(w.zU_,{className:"text-gray-600 group-hover:text-blue-500 transition-colors duration-200"})}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,s.jsx)(_.A,{language:"bash",className:"!m-0 rounded-md overflow-x-auto",customStyle:{backgroundColor:"#f5f5f5"},children:e.commandText})})]},"cmd-".concat(t)))}):(0,s.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md text-gray-500 italic",children:["No commands available."," ",(null==t?void 0:t.password)||(null==t?void 0:t.ntlmHash)?l?"Try adjusting your search term.":"":"Add a password or NTLM hash to see available commands."]})},I=e=>{let{children:t,title:a,className:n=""}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 ".concat(n),children:[a&&(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:a}),t]})};a(799);let R=e=>{let{openDomainModal:t}=e,{selectedDomain:a,selectedAccount:r}=f(),[l,o]=(0,n.useState)(""),[c,i]=(0,n.useState)("");return a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.N9,{position:"bottom-center"}),(0,s.jsx)("div",{className:"flex h-full flex-col",children:(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsx)("aside",{className:"w-72 flex-shrink-0 h-full overflow-hidden border-r border-gray-200 shadow-sm bg-white",children:(0,s.jsx)(k,{className:"h-full"})}),(0,s.jsx)("main",{className:"flex-1 overflow-auto p-0 bg-gray-50",children:r?(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-3 mb-3",children:(0,s.jsx)(O,{selectedAccount:r,selectedDomain:a})}),(0,s.jsx)(I,{title:"Connection Options",className:"mb-3 py-2",children:(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(j,{label:"Target Host",type:"text",value:l,onChange:e=>o(e.target.value),placeholder:"Enter target hostname or IP"})})}),(0,s.jsx)("div",{className:"bg-white p-3 rounded-lg border border-gray-200 mb-3 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center w-full",children:[(0,s.jsx)(w.KSO,{className:"text-gray-400 text-xl flex-shrink-0 mr-2"}),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(j,{value:c,onChange:e=>i(e.target.value),placeholder:"Search commands (e.g., 'rdp', 'wmi', 'psexec'...)",className:"w-full border-gray-300 focus:ring-blue-500 focus:border-blue-500"})})]})}),(0,s.jsx)(I,{title:"Available Commands",className:"mb-4 py-2",children:(0,s.jsx)(M,{selectedAccount:r,selectedDomain:a,targetHost:l,searchTerm:c})}),(0,s.jsx)("div",{className:"text-center mt-2 mb-4",children:(0,s.jsxs)("a",{href:"https://github.com/Vincent550102/nPassword",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center text-gray-500 hover:text-blue-600 transition-colors text-xs",children:[(0,s.jsx)(w.hL4,{className:"mr-1",size:12}),(0,s.jsx)("span",{children:"Open Source on GitHub"})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,s.jsxs)("div",{className:"text-center p-6 max-w-md bg-white rounded-lg shadow-sm",children:[(0,s.jsx)("div",{className:"flex justify-center mb-3",children:(0,s.jsx)("div",{className:"bg-blue-50 text-blue-500 p-3 rounded-full",children:(0,s.jsx)(w.KSO,{size:24})})}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Select an account from the sidebar"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Choose an account to view details and available commands."})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("a",{href:"https://github.com/Vincent550102/nPassword",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-gray-500 hover:text-blue-600 transition-colors text-sm",children:[(0,s.jsx)(w.hL4,{className:"mr-1",size:14}),(0,s.jsx)("span",{children:"Open Source on GitHub"})]})})]})})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,s.jsxs)("div",{className:"text-center p-6 max-w-lg",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"bg-blue-100 text-blue-600 p-4 rounded-full",children:(0,s.jsx)(w.vwk,{size:36})})}),(0,s.jsx)("h2",{className:"text-3xl font-bold mb-3 text-gray-800",children:"Welcome to nPassword"}),(0,s.jsx)("p",{className:"mb-5 text-gray-600 text-lg",children:"A lightweight password manager for Windows Active Directory"}),(0,s.jsxs)("button",{onClick:t,className:"flex items-center justify-center mx-auto bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-5 rounded-lg transition-colors",children:[(0,s.jsx)(w.OiG,{className:"mr-2"}),"Select or Create Domain"]})]}),(0,s.jsx)("div",{className:"absolute bottom-4 text-center",children:(0,s.jsxs)("a",{href:"https://github.com/Vincent550102/nPassword",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-gray-500 hover:text-blue-600 transition-colors text-sm",children:[(0,s.jsx)(w.hL4,{className:"mr-1",size:16}),(0,s.jsx)("span",{children:"Open Source on GitHub"})]})})]})},z=e=>{if(e)try{let t=JSON.stringify(e,null,2),a=new Blob([t],{type:"application/json"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="".concat(e.name,".json"),n.click(),URL.revokeObjectURL(s)}catch(e){throw console.error("Error exporting domain data:",e),Error("Failed to export domain data")}},P=e=>{if(e)try{let t=e.accounts.map(e=>e.username).join("\n"),a=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="".concat(e.name,"_users.txt"),n.click(),URL.revokeObjectURL(s)}catch(e){throw console.error("Error exporting usernames:",e),Error("Failed to export usernames")}},F=e=>new Promise((t,a)=>{let s=new FileReader;s.onload=e=>{try{var s;let a=null===(s=e.target)||void 0===s?void 0:s.result,n=JSON.parse(a);if(G(n))t(n);else throw Error("Invalid domain data format")}catch(e){console.error("Error parsing domain file:",e),a(e)}},s.onerror=()=>{a(Error("Failed to read file"))},s.readAsText(e)}),G=e=>!!e&&"object"==typeof e&&!!("string"==typeof e.name&&Array.isArray(e.accounts))&&e.accounts.every(e=>!!e&&"object"==typeof e&&"string"==typeof e.username&&("domain"===e.type||"local"===e.type)),q=e=>{let{openDomainModal:t}=e,{selectedDomain:a}=f(),{selectDomain:r,deleteDomain:l}=y(),[o,c]=(0,n.useState)(!1),[i,m]=(0,n.useState)(!1),d=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return o&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]),(0,s.jsxs)("nav",{className:"bg-gray-800 text-white py-3 px-4 shadow-md",children:[(0,s.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("h1",{className:"text-xl font-bold tracking-tight mr-4",children:"nPassword"}),(0,s.jsxs)("a",{href:"https://github.com/Vincent550102/nPassword",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-gray-300 hover:text-white transition-colors",title:"Open Source on GitHub",children:[(0,s.jsx)(w.hL4,{size:18,className:"mr-1"}),(0,s.jsx)("span",{className:"text-sm hidden sm:inline",children:"Open Source"})]})]}),a?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"flex items-center mr-6 bg-gray-700 px-3 py-1.5 rounded",children:[(0,s.jsx)(w.vwk,{className:"mr-2 text-gray-300"}),(0,s.jsx)("span",{className:"font-medium",children:a.name})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",ref:d,children:[(0,s.jsxs)("button",{onClick:()=>c(!o),className:"flex items-center bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded transition-colors","aria-expanded":o,"aria-haspopup":"true",children:[(0,s.jsx)(w.WCW,{className:"mr-2"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Export"})]}),o&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10",role:"menu","aria-orientation":"vertical",children:[(0,s.jsx)("button",{onClick:()=>{if(a){try{z(a),v.oR.success("Domain exported successfully!")}catch(e){console.error("Export error:",e),v.oR.error("Failed to export domain")}c(!1)}},className:"block w-full text-left px-4 py-2 text-gray-800 hover:bg-gray-100",role:"menuitem",children:"Export Domain Data"}),(0,s.jsx)("button",{onClick:()=>{if(a){try{P(a),v.oR.success("Usernames exported successfully!")}catch(e){console.error("Export error:",e),v.oR.error("Failed to export usernames")}c(!1)}},className:"block w-full text-left px-4 py-2 text-gray-800 hover:bg-gray-100",role:"menuitem",children:"Export Usernames Only"}),(0,s.jsx)("div",{className:"border-t border-gray-200 my-1"}),(0,s.jsx)("button",{onClick:()=>{c(!1),m(!0)},className:"block w-full text-left px-4 py-2 text-red-600 hover:bg-red-50",role:"menuitem",children:"Delete Domain"})]})]}),(0,s.jsxs)("button",{onClick:t,className:"flex items-center bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded transition-colors",title:"Switch Domain",children:[(0,s.jsx)(w.yk7,{className:"mr-2"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Switch"})]})]})]}):(0,s.jsxs)("button",{onClick:t,className:"flex items-center bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded transition-colors",children:[(0,s.jsx)(w.vwk,{className:"mr-2"}),(0,s.jsx)("span",{children:"Select Domain"})]})]}),i&&a&&(0,s.jsx)(N,{onCloseAction:()=>m(!1),children:(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"flex items-center text-red-600 mb-4",children:[(0,s.jsx)(w.qbC,{size:22,className:"mr-3"}),(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Delete Domain"})]}),(0,s.jsxs)("p",{className:"mb-4",children:["Are you sure you want to delete the domain"," ",(0,s.jsx)("strong",{children:a.name}),"?"]}),(0,s.jsx)("p",{className:"mb-6 text-gray-600 text-sm bg-yellow-50 p-3 rounded border border-yellow-200",children:"This action cannot be undone. All accounts and credentials in this domain will be permanently removed."}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded text-gray-800",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{a&&(m(!1),l(a.name),r(null),v.oR.success('Domain "'.concat(a.name,'" deleted successfully!')))},className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded text-white",children:"Delete Domain"})]})]})})]})},V=e=>{let{children:t,openDomainModal:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"sticky top-0 z-50",children:(0,s.jsx)(q,{openDomainModal:a})}),(0,s.jsx)("main",{className:"flex-grow flex flex-col relative",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-6 flex-grow flex flex-col",children:t})}),(0,s.jsx)("footer",{className:"bg-gray-800 text-white text-center py-4 text-sm mt-auto",children:(0,s.jsxs)("div",{className:"container mx-auto",children:[(0,s.jsx)("p",{children:"nPassword - A lightweight password manager for Windows Active Directory"}),(0,s.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"For research and educational purposes only"})]})})]})},W=()=>{let{domains:e,selectedDomain:t}=f(),{selectDomain:a,addDomain:r,loadDomainData:l}=y(),[o,c]=(0,n.useState)(!1),i=(0,n.useRef)(!1);(0,n.useEffect)(()=>{i.current||(i.current=!0,!t&&e.length>0&&c(!0))},[e,t]);let m=e=>{a(e),c(!1)},d=()=>{c(!0)},u=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a)try{let e=await F(a);l(e),c(!1)}catch(e){console.error("Error loading domain:",e),alert("Failed to load domain. The file format may be invalid.")}};return(0,s.jsxs)(V,{openDomainModal:d,children:[o&&(0,s.jsx)(H,{domains:e,onCloseAction:()=>{(t||0===e.length)&&c(!1)},onSelectDomain:m,onAddDomain:e=>{r(e),m(e)},onLoadDomain:u}),(0,s.jsx)(R,{openDomainModal:d})]})},B=()=>(0,s.jsx)(W,{});function J(){return(0,s.jsx)(x,{children:(0,s.jsx)(B,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[38,56,218,401,118,851,358],()=>t(25296)),_N_E=e.O()}]);